<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Olympus Method — Warm-Up & Log</title>

<!-- Inter font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    :root {
        --az-dark: #1b1f23;
        --az-bg: #264653;
        --az-bg-soft: #287271;
        --az-accent: #2a9d8f;
        --az-yellow: #e9c46a;
        --az-orange: #f4a261;
        --az-salmon: #ee8959;
        --az-red: #e76f51;
        --radius: 14px;
    }

    * {
        box-sizing: border-box;
    }

    body {
        margin: 0;
        padding: 20px;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: radial-gradient(circle at top, #264653 0, #0b0f10 55%);
        color: #f7f7f7;
    }

    .app {
        max-width: 980px;
        margin: 0 auto;
        background: rgba(10, 14, 18, 0.95);
        border-radius: 20px;
        padding: 20px 20px 64px; /* extra bottom for footer */
        box-shadow: 0 18px 40px rgba(0,0,0,0.6);
        border: 1px solid rgba(233,196,106,0.18);
        position: relative;
    }

    header {
        display: flex;
        flex-wrap: wrap;
        align-items: baseline;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 14px;
    }

    h1 {
        font-size: 1.6rem;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    h1 span.logo-pill {
        font-size: 0.75rem;
        padding: 2px 8px;
        border-radius: 999px;
        background: var(--az-accent);
        color: #0b0f10;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }

    .tagline {
        font-size: 0.85rem;
        color: #c9d6df;
        opacity: 0.9;
    }

    /* Tabs */
    .tabs {
        display: flex;
        gap: 6px;
        margin-bottom: 14px;
        flex-wrap: wrap;
    }

    .tab-button {
        border-radius: 999px;
        padding: 6px 14px;
        border: 1px solid rgba(148,163,184,0.6);
        background: rgba(15,23,42,0.8);
        color: #e5e7eb;
        font-size: 0.85rem;
        cursor: pointer;
    }

    .tab-button.active {
        border-color: transparent;
        background: linear-gradient(135deg, var(--az-orange), var(--az-red));
        color: #0b0f10;
        font-weight: 600;
        box-shadow: 0 6px 14px rgba(231,111,81,0.45);
    }

    .tab-panel {
        display: none;
        margin-top: 4px;
    }

    .tab-panel.active {
        display: block;
    }

    .grid {
        display: grid;
        grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.1fr);
        gap: 18px;
    }

    @media (max-width: 780px) {
        .grid {
            grid-template-columns: minmax(0, 1fr);
        }
    }

    .card {
        background: linear-gradient(145deg, #101619, #172024);
        border-radius: var(--radius);
        padding: 16px 16px 18px;
        border: 1px solid rgba(42,157,143,0.2);
    }

    .card h2 {
        margin: 0 0 8px;
        font-size: 1.05rem;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .card h2 span.badge {
        font-size: 0.7rem;
        padding: 2px 8px;
        border-radius: 999px;
        background: rgba(244,162,97,0.15);
        color: var(--az-yellow);
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }

    label {
        display: block;
        font-size: 0.8rem;
        margin-top: 8px;
        margin-bottom: 2px;
        color: #e0e5ec;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }

    select, input[type="number"], textarea {
        width: 100%;
        padding: 8px 10px;
        font-size: 0.9rem;
        border-radius: 8px;
        border: 1px solid rgba(148,163,184,0.5);
        background: #0b1114;
        color: #f9fafb;
        outline: none;
        resize: vertical;
    }

    select:focus, input[type="number"]:focus, textarea:focus {
        border-color: var(--az-accent);
        box-shadow: 0 0 0 1px rgba(42,157,143,0.7);
    }

    .row {
        display: flex;
        gap: 10px;
    }

    .row > div {
        flex: 1;
    }

    .unit-toggle {
        display: inline-flex;
        background: #0b1114;
        border-radius: 999px;
        padding: 3px;
        border: 1px solid rgba(148,163,184,0.6);
    }

    .unit-toggle button {
        border: none;
        padding: 6px 14px;
        border-radius: 999px;
        font-size: 0.8rem;
        cursor: pointer;
        background: transparent;
        color: #e5e7eb;
    }

    .unit-toggle button.active {
        background: var(--az-accent);
        color: #0b0f10;
        font-weight: 600;
    }

    .btn-main {
        width: 100%;
        margin-top: 12px;
        padding: 10px;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        font-size: 0.95rem;
        font-weight: 600;
        background: linear-gradient(135deg, var(--az-orange), var(--az-red));
        color: #0b0f10;
        box-shadow: 0 10px 20px rgba(231,111,81,0.4);
        transition: transform 0.05s ease, box-shadow 0.05s ease;
    }

    .btn-main:hover {
        transform: translateY(-1px);
        box-shadow: 0 14px 24px rgba(231,111,81,0.55);
    }

    .btn-main:active {
        transform: translateY(0);
        box-shadow: 0 6px 14px rgba(231,111,81,0.4);
    }

    .btn-secondary {
        width: 100%;
        margin-top: 10px;
        padding: 9px;
        border-radius: 999px;
        border: 1px solid rgba(148,163,184,0.6);
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 500;
        background: rgba(15,23,42,0.9);
        color: #e5e7eb;
    }

    .btn-secondary:hover {
        border-color: var(--az-accent);
    }

    .btn-ghost {
        border-radius: 999px;
        padding: 6px 12px;
        border: 1px dashed rgba(148,163,184,0.5);
        background: transparent;
        color: #e5e7eb;
        font-size: 0.8rem;
        cursor: pointer;
    }

    .btn-ghost:hover {
        border-style: solid;
        border-color: var(--az-accent);
    }

    .sets-table {
        margin-top: 6px;
        width: 100%;
        border-collapse: collapse;
        font-size: 0.85rem;
    }

    .sets-table thead {
        background: rgba(42,157,143,0.1);
    }

    .sets-table th,
    .sets-table td {
        padding: 6px 6px;
        border-bottom: 1px solid rgba(55,65,81,0.6);
        text-align: left;
    }

    .sets-table th {
        font-weight: 600;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        color: #e5e7eb;
    }

    .sets-table tr:last-child td {
        border-bottom: none;
    }

    .pill {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 2px 8px;
        border-radius: 999px;
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        border: 1px solid rgba(148,163,184,0.6);
    }

    .pill.work {
        border-color: rgba(248,250,252,0.7);
        color: var(--az-yellow);
    }

    .pill.warm {
        border-color: rgba(56,189,248,0.7);
        color: #bae6fd;
    }

    .empty-note {
        font-size: 0.8rem;
        color: #9ca3af;
        margin-top: 10px;
    }

    .footer-note {
        margin-top: 14px;
        font-size: 0.7rem;
        color: #9ca3af;
        opacity: 0.8;
    }

    .template-hint {
        margin-top: 4px;
        font-size: 0.75rem;
        color: #cbd5f5;
        opacity: 0.9;
    }

    .template-hint span {
        color: var(--az-yellow);
        font-weight: 600;
    }

    .chip-row {
        margin-top: 6px;
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        font-size: 0.7rem;
    }

    .chip {
        padding: 2px 8px;
        border-radius: 999px;
        background: rgba(148,163,184,0.15);
        border: 1px solid rgba(148,163,184,0.3);
    }

    .subsection-title {
        margin-top: 12px;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #e5e7eb;
        opacity: 0.9;
    }

    /* Exercise cards */
    .exercise-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 6px;
    }

    .exercise-card {
        background: rgba(15,23,42,0.9);
        border-radius: 10px;
        border: 1px solid rgba(148,163,184,0.4);
        overflow: hidden;
    }

    .exercise-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 10px;
        cursor: pointer;
        background: radial-gradient(circle at top left, rgba(244,162,97,0.12), rgba(15,23,42,0.95));
    }

    .exercise-header-left {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .exercise-toggle {
        border: none;
        background: rgba(15,23,42,0.9);
        color: #e5e7eb;
        border-radius: 999px;
        width: 22px;
        height: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        cursor: pointer;
    }

    .exercise-name {
        font-size: 0.9rem;
        font-weight: 600;
    }

    .exercise-body {
        padding: 8px 10px 10px;
        border-top: 1px solid rgba(31,41,55,0.8);
    }

    .exercise-body.collapsed {
        display: none;
    }

    .sets-container {
        display: flex;
        flex-direction: column;
        gap: 4px;
        margin-bottom: 6px;
    }

    .set-row {
        display: grid;
        grid-template-columns: auto minmax(0,1fr) minmax(0,1fr) auto;
        gap: 6px;
        align-items: center;
    }

    .set-label {
        font-size: 0.75rem;
        color: #e5e7eb;
        opacity: 0.9;
    }

    .set-row input {
        width: 100%;
    }

    .remove-set-btn {
        border: none;
        background: transparent;
        color: #fca5a5;
        cursor: pointer;
        font-size: 1rem;
        padding: 0 4px;
    }

    .notes-label {
        margin-top: 6px;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #9ca3af;
    }

    .exercise-actions {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        margin-top: 10px;
    }

    .exercise-actions .btn-ghost {
        flex: 1;
        text-align: center;
    }

    /* Day save */
    .day-save-row {
        margin-top: 10px;
        display: flex;
        justify-content: flex-end;
    }

    /* Timer footer */
    .timer-footer {
        position: sticky;
        bottom: 0;
        left: 0;
        margin-top: 18px;
        padding: 8px 10px;
        background: rgba(15,23,42,0.97);
        border-radius: 12px;
        border: 1px solid rgba(148,163,184,0.6);
        display: flex;
        gap: 12px;
        align-items: center;
        justify-content: space-between;
    }

    .timer-block {
        display: flex;
        flex-direction: column;
        gap: 4px;
        flex: 1;
    }

    .timer-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #e5e7eb;
        opacity: 0.9;
    }

    .timer-display {
        font-size: 1.1rem;
        font-weight: 600;
    }

    .timer-controls {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
    }

    .timer-btn {
        border-radius: 999px;
        padding: 4px 10px;
        border: 1px solid rgba(148,163,184,0.7);
        background: rgba(15,23,42,0.9);
        color: #e5e7eb;
        font-size: 0.75rem;
        cursor: pointer;
    }

    .timer-btn.primary {
        border-color: var(--az-accent);
    }

    .timer-btn:hover {
        border-color: var(--az-accent);
    }

    .rest-presets {
        display: flex;
        gap: 4px;
        flex-wrap: wrap;
        margin-top: 2px;
    }

    .rest-presets .timer-btn {
        padding: 3px 8px;
    }

    @media (max-width: 700px) {
        .timer-footer {
            flex-direction: column;
            align-items: stretch;
        }
    }
</style>
</head>
<body>

<div class="app">
    <header>
        <div>
            <h1>
                Olympus Method
                <span class="logo-pill">Arizona Sunset</span>
            </h1>
            <div class="tagline">
                Heavy-Duty warm-ups, plates, timers, and logbook — with full 3-day Push / Legs / Pull tracking.
            </div>
        </div>
    </header>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab-button active" data-target="tab-calculator">Calculator & Log</button>
        <button class="tab-button" data-target="tab-push">Day 1 — Push</button>
        <button class="tab-button" data-target="tab-legs">Day 2 — Legs</button>
        <button class="tab-button" data-target="tab-pull">Day 3 — Pull</button>
    </div>

    <!-- TAB 1: CALCULATOR -->
    <section id="tab-calculator" class="tab-panel active">
        <div class="grid">
            <!-- LEFT: Inputs -->
            <div class="card">
                <h2>
                    Lift Setup
                    <span class="badge">Input</span>
                </h2>

                <label for="liftSelect">Lift</label>
                <select id="liftSelect">
                    <option value="bench">Bench Press</option>
                    <option value="squat">Back Squat</option>
                    <option value="deadlift">Deadlift</option>
                    <option value="ohp">Overhead Press</option>
                    <option value="row">Barbell Row</option>
                    <option value="pullups">Pull-Ups (weighted)</option>
                    <option value="custom">Custom / Other</option>
                </select>

                <div class="row">
                    <div>
                        <label for="workingWeight">Working Set Weight</label>
                        <input type="number" id="workingWeight" placeholder="e.g. 100" step="0.5" min="0" />
                    </div>
                    <div>
                        <label>Unit</label>
                        <div class="unit-toggle">
                            <button type="button" id="kgBtn" class="active">kg</button>
                            <button type="button" id="lbBtn">lb</button>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div>
                        <label for="barWeight">Bar Weight</label>
                        <input type="number" id="barWeight" placeholder="20 for kg / 45 for lb" step="0.5" min="0" />
                    </div>
                    <div>
                        <label for="templateSelect">Warm-Up Template</label>
                        <select id="templateSelect">
                            <option value="heavyDuty">Heavy Duty (30% & 50%)</option>
                            <option value="mentzer">Mike Mentzer</option>
                            <option value="twoWarmups">2 Warm-Ups Only</option>
                        </select>
                    </div>
                </div>

                <div class="template-hint" id="templateHint"></div>

                <button class="btn-main" id="calcBtn">Calculate Warm-Ups & Plates</button>

                <div class="subsection-title">Log Top Set</div>

                <div class="row">
                    <div>
                        <label for="actualReps">Actual Reps (top set)</label>
                        <input type="number" id="actualReps" placeholder="e.g. 8" min="0" step="1" />
                    </div>
                </div>

                <button class="btn-secondary" id="saveSessionBtn">
                    Save Session & Show Progression
                </button>

                <div class="chip-row">
                    <div class="chip">Use warm-ups on the FIRST big lift of the day</div>
                    <div class="chip">Accessories: usually straight to working set</div>
                </div>

                <div class="footer-note">
                    For true Heavy Duty style: 2 brief warm-ups, then 1 all-out set to failure (6–10 reps).
                </div>
            </div>

            <!-- RIGHT: Results -->
            <div class="card">
                <h2>
                    Warm-Ups, Plates & Progression
                    <span class="badge">Output</span>
                </h2>

                <table class="sets-table" id="resultsTable" style="display:none;">
                    <thead>
                        <tr>
                            <th>Set</th>
                            <th>Type</th>
                            <th>% of Work</th>
                            <th>Reps</th>
                            <th>Target</th>
                            <th>Plates / side</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody"></tbody>
                </table>

                <div class="empty-note" id="emptyNote">
                    Enter your working weight & bar, choose a template, and hit <strong>Calculate</strong>.
                </div>

                <div id="previousStats" class="empty-note" style="display:none;"></div>
                <div id="suggestionText" class="empty-note" style="display:none;"></div>
            </div>
        </div>
    </section>

    <!-- TAB 2: PUSH -->
    <section id="tab-push" class="tab-panel">
        <div class="card">
            <h2>
                Day 1 — Push
                <span class="badge">Chest / Shoulders / Triceps</span>
            </h2>
            <p class="subsection-title" style="margin-top:4px;">Exercises</p>

            <div class="exercise-list" id="pushExercises"></div>

            <div class="exercise-actions">
                <button type="button" class="btn-ghost add-exercise-btn" data-day="push">+ Add Exercise</button>
            </div>

            <div class="day-save-row">
                <button type="button" class="btn-secondary save-day-btn" data-day="push">Save Day 1 Log</button>
            </div>
        </div>
    </section>

    <!-- TAB 3: LEGS -->
    <section id="tab-legs" class="tab-panel">
        <div class="card">
            <h2>
                Day 2 — Legs
                <span class="badge">Quads / Hams / Calves</span>
            </h2>
            <p class="subsection-title" style="margin-top:4px;">Exercises</p>

            <div class="exercise-list" id="legsExercises"></div>

            <div class="exercise-actions">
                <button type="button" class="btn-ghost add-exercise-btn" data-day="legs">+ Add Exercise</button>
            </div>

            <div class="day-save-row">
                <button type="button" class="btn-secondary save-day-btn" data-day="legs">Save Day 2 Log</button>
            </div>
        </div>
    </section>

    <!-- TAB 4: PULL -->
    <section id="tab-pull" class="tab-panel">
        <div class="card">
            <h2>
                Day 3 — Pull
                <span class="badge">Back / Rear Delts / Biceps</span>
            </h2>
            <p class="subsection-title" style="margin-top:4px;">Exercises</p>

            <div class="exercise-list" id="pullExercises"></div>

            <div class="exercise-actions">
                <button type="button" class="btn-ghost add-exercise-btn" data-day="pull">+ Add Exercise</button>
            </div>

            <div class="day-save-row">
                <button type="button" class="btn-secondary save-day-btn" data-day="pull">Save Day 3 Log</button>
            </div>
        </div>
    </section>

    <!-- TIMER FOOTER -->
    <div class="timer-footer">
        <div class="timer-block">
            <div class="timer-label">Workout Timer</div>
            <div class="timer-display" id="workoutDisplay">00:00</div>
            <div class="timer-controls">
                <button class="timer-btn primary" id="workoutStartPause">Start</button>
                <button class="timer-btn" id="workoutReset">Reset</button>
            </div>
        </div>

        <div class="timer-block">
            <div class="timer-label">Rest Timer</div>
            <div class="timer-display" id="restDisplay">00s</div>
            <div class="rest-presets">
                <button class="timer-btn rest-preset" data-sec="60">60s</button>
                <button class="timer-btn rest-preset" data-sec="90">90s</button>
                <button class="timer-btn rest-preset" data-sec="120">120s</button>
            </div>
            <div class="timer-controls">
                <button class="timer-btn primary" id="restStartPause">Start</button>
                <button class="timer-btn" id="restReset">Reset</button>
            </div>
        </div>
    </div>
</div>

<script>
    // ---- Tabs ----
    const tabButtons = document.querySelectorAll(".tab-button");
    const tabPanels = document.querySelectorAll(".tab-panel");

    tabButtons.forEach(btn => {
        btn.addEventListener("click", () => {
            const target = btn.getAttribute("data-target");

            tabButtons.forEach(b => b.classList.remove("active"));
            tabPanels.forEach(p => p.classList.remove("active"));

            btn.classList.add("active");
            document.getElementById(target).classList.add("active");
        });
    });

    // ---- Warm-up logic / calculator ----
    const TEMPLATES = {
        heavyDuty: {
            name: "Heavy Duty (30% & 50%)",
            description: "Olympus-style: 30% x 5, 50% x 3–5, then 100% x 6–10 to failure.",
            sets: [
                { type: "Warm-up", percent: 0.30, reps: "5" },
                { type: "Warm-up", percent: 0.50, reps: "3–5" },
                { type: "Working", percent: 1.00, reps: "6–10 (to failure)" }
            ]
        },
        mentzer: {
            name: "Mike Mentzer",
            description: "Classic low-volume: 50% x 6–8, 75% x 3–4, 100% x 6–10 to failure.",
            sets: [
                { type: "Warm-up", percent: 0.50, reps: "6–8" },
                { type: "Warm-up", percent: 0.75, reps: "3–4" },
                { type: "Working", percent: 1.00, reps: "6–10 (to failure)" }
            ]
        },
        twoWarmups: {
            name: "2 Warm-Ups Only (Minimalist)",
            description: "40% x 5, 70% x 2–3, then 100% working set.",
            sets: [
                { type: "Warm-up", percent: 0.40, reps: "5" },
                { type: "Warm-up", percent: 0.70, reps: "2–3" },
                { type: "Working", percent: 1.00, reps: "6–10 (to failure)" }
            ]
        }
    };

    const KG_PLATES = [25, 20, 15, 10, 5, 2.5, 1.25];
    const LB_PLATES = [45, 35, 25, 10, 5, 2.5];

    let currentUnit = "kg";

    const liftSelect = document.getElementById("liftSelect");
    const workingWeightInput = document.getElementById("workingWeight");
    const barWeightInput = document.getElementById("barWeight");
    const templateSelect = document.getElementById("templateSelect");
    const templateHint = document.getElementById("templateHint");
    const resultsTable = document.getElementById("resultsTable");
    const resultsBody = document.getElementById("resultsBody");
    const emptyNote = document.getElementById("emptyNote");
    const kgBtn = document.getElementById("kgBtn");
    const lbBtn = document.getElementById("lbBtn");
    const calcBtn = document.getElementById("calcBtn");
    const saveSessionBtn = document.getElementById("saveSessionBtn");
    const actualRepsInput = document.getElementById("actualReps");
    const previousStatsDiv = document.getElementById("previousStats");
    const suggestionTextDiv = document.getElementById("suggestionText");

    function updateTemplateHint() {
        const tKey = templateSelect.value;
        const t = TEMPLATES[tKey];
        if (!t) {
            templateHint.textContent = "";
            return;
        }
        templateHint.innerHTML = `<span>${t.name}:</span> ${t.description}`;
    }

    templateSelect.addEventListener("change", updateTemplateHint);
    updateTemplateHint();

    kgBtn.addEventListener("click", () => setUnit("kg"));
    lbBtn.addEventListener("click", () => setUnit("lb"));

    function setUnit(unit) {
        currentUnit = unit;
        if (unit === "kg") {
            kgBtn.classList.add("active");
            lbBtn.classList.remove("active");
            if (!barWeightInput.value) barWeightInput.value = 20;
        } else {
            lbBtn.classList.add("active");
            kgBtn.classList.remove("active");
            if (!barWeightInput.value) barWeightInput.value = 45;
        }
    }

    function formatWeight(value) {
        if (!isFinite(value)) return "-";
        return value.toFixed(1).replace(/\.0$/, "");
    }

    function plateConfig() {
        return currentUnit === "kg" ? KG_PLATES : LB_PLATES;
    }

    function computePlates(targetWeight, barWeight) {
        const plateSizes = plateConfig();
        const epsilon = 1e-6;

        if (targetWeight < barWeight - epsilon) {
            return { text: "Bar only", raw: [] };
        }

        let remainingTotal = targetWeight - barWeight;
        if (remainingTotal < 0) remainingTotal = 0;

        let perSide = remainingTotal / 2;
        const platesPerSide = [];

        for (const p of plateSizes) {
            let count = Math.floor((perSide + epsilon) / p);
            if (count > 0) {
                platesPerSide.push({ size: p, count });
                perSide -= count * p;
            }
        }

        if (platesPerSide.length === 0) {
            return { text: "Bar only", raw: [] };
        }

        const text = platesPerSide
            .map(pl => `${formatWeight(pl.size)} × ${pl.count}`)
            .join(", ");

        return { text: text + " / side", raw: platesPerSide };
    }

    function calculateWarmups() {
        const work = parseFloat(workingWeightInput.value);
        const bar = parseFloat(barWeightInput.value);

        if (!isFinite(work) || work <= 0) {
            alert("Enter a valid working set weight.");
            return;
        }
        if (!isFinite(bar) || bar <= 0) {
            alert("Enter a valid bar weight.");
            return;
        }

        const tpl = TEMPLATES[templateSelect.value];
        resultsBody.innerHTML = "";

        tpl.sets.forEach((set, idx) => {
            const target = work * set.percent;
            const plates = computePlates(target, bar);

            const tr = document.createElement("tr");

            tr.innerHTML = `
                <td>${idx + 1}</td>
                <td><span class="pill ${set.type === "Working" ? "work" : "warm"}">${set.type}</span></td>
                <td>${Math.round(set.percent * 100)}%</td>
                <td>${set.reps}</td>
                <td>${formatWeight(target)} ${currentUnit}</td>
                <td>${plates.text}</td>
            `;

            resultsBody.appendChild(tr);
        });

        resultsTable.style.display = "table";
        emptyNote.style.display = "none";
    }

    calcBtn.addEventListener("click", calculateWarmups);

    // LocalStorage log (calculator)
    const LOG_KEY = "olympusLogs_v1";

    function loadLogs() {
        try {
            const raw = localStorage.getItem(LOG_KEY);
            return raw ? JSON.parse(raw) : [];
        } catch {
            return [];
        }
    }

    function saveLogs(logs) {
        localStorage.setItem(LOG_KEY, JSON.stringify(logs));
    }

    function getIncrement(unit) {
        return unit === "kg" ? 2.5 : 5;
    }

    function suggestNextWeight(weight, reps, unit) {
        const inc = getIncrement(unit);
        if (reps >= 10) return weight + inc;
        if (reps <= 5) return Math.max(0, weight - inc);
        return weight;
    }

    function formatDateShort(iso) {
        const d = new Date(iso);
        return d.toLocaleDateString(undefined, { day: "2-digit", month: "2-digit" });
    }

    function updateProgressSection(lift, unit) {
        const logs = loadLogs().filter(l => l.lift === lift && l.unit === unit);

        if (logs.length < 2) {
            previousStatsDiv.style.display = "block";
            previousStatsDiv.textContent = "Not enough history yet.";
            suggestionTextDiv.style.display = "none";
            return;
        }

        logs.sort((a, b) => new Date(a.date) - new Date(b.date));

        const prev = logs[logs.length - 2];
        const curr = logs[logs.length - 1];

        previousStatsDiv.style.display = "block";
        previousStatsDiv.innerHTML =
            `Last session: <strong>${formatWeight(prev.weight)} ${unit} × ${prev.reps}</strong> on ${formatDateShort(prev.date)}<br>` +
            `Today: <strong>${formatWeight(curr.weight)} ${unit} × ${curr.reps}</strong>`;

        const suggested = suggestNextWeight(curr.weight, curr.reps, unit);

        suggestionTextDiv.style.display = "block";
        suggestionTextDiv.innerHTML = `Next target: <strong>${formatWeight(suggested)} ${unit}</strong>`;
    }

    function saveSession() {
        const weight = parseFloat(workingWeightInput.value);
        const reps = parseInt(actualRepsInput.value, 10);
        const lift = liftSelect.value;

        if (!isFinite(weight) || weight <= 0) return alert("Enter weight");
        if (!reps || reps <= 0) return alert("Enter reps");

        const logs = loadLogs();
        logs.push({
            lift,
            unit: currentUnit,
            weight,
            reps,
            date: new Date().toISOString()
        });

        saveLogs(logs);
        updateProgressSection(lift, currentUnit);

        alert("Session saved!");
    }

    saveSessionBtn.addEventListener("click", saveSession);

    // ---- Exercise logging per day ----
    const DEFAULT_SPLIT = {
        push: [
            "Incline Barbell Bench Press",
            "Flat Barbell Bench Press",
            "Weighted Dips (Chest-focused)",
            "Dumbbell Lateral Raises",
            "Rope Pushdown / Skull Crushers"
        ],
        legs: [
            "Barbell Back Squat",
            "Romanian Deadlift",
            "Hamstring Curl (Machine)",
            "Calf Raises",
            "Leg Press / Hack Squat"
        ],
        pull: [
            "Weighted Pull-Ups",
            "Bent-Over Barbell Row",
            "Barbell Biceps Curl",
            "Rear Delt Flys",
            "Barbell Shrugs"
        ]
    };

    const DAY_CONTAINERS = {
        push: document.getElementById("pushExercises"),
        legs: document.getElementById("legsExercises"),
        pull: document.getElementById("pullExercises")
    };

    const DAY_LOG_KEY = "olympusDayLogs_v1";

    function loadDayLogs() {
        try {
            const raw = localStorage.getItem(DAY_LOG_KEY);
            return raw ? JSON.parse(raw) : [];
        } catch {
            return [];
        }
    }

    function saveDayLogs(logs) {
        localStorage.setItem(DAY_LOG_KEY, JSON.stringify(logs));
    }

    function escapeHtml(str) {
        return str.replace(/[&<>"']/g, function (c) {
            return ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;"
            })[c];
        });
    }

    function addSetRow(card) {
        const container = card.querySelector(".sets-container");
        const index = container.children.length + 1;
        const row = document.createElement("div");
        row.className = "set-row";
        row.innerHTML = `
            <span class="set-label">Set ${index}</span>
            <input type="number" class="set-weight" placeholder="Weight" step="0.5" />
            <input type="number" class="set-reps" placeholder="Reps" step="1" />
            <button type="button" class="remove-set-btn">×</button>
        `;
        container.appendChild(row);

        const removeBtn = row.querySelector(".remove-set-btn");
        removeBtn.addEventListener("click", () => {
            row.remove();
            Array.from(container.children).forEach((r, i) => {
                const label = r.querySelector(".set-label");
                if (label) label.textContent = `Set ${i + 1}`;
            });
        });
    }

    function createExerciseCard(dayKey, name) {
        const container = DAY_CONTAINERS[dayKey];
        if (!container) return;

        const card = document.createElement("div");
        card.className = "exercise-card";

        card.innerHTML = `
            <div class="exercise-header">
                <div class="exercise-header-left">
                    <button type="button" class="exercise-toggle">▼</button>
                    <span class="exercise-name">${escapeHtml(name)}</span>
                </div>
            </div>
            <div class="exercise-body">
                <div class="sets-container"></div>
                <button type="button" class="btn-ghost add-set-btn">+ Add Set</button>
                <label class="notes-label">Notes</label>
                <textarea class="exercise-notes" rows="2" placeholder="Notes, RPE, technique..."></textarea>
            </div>
        `;

        const body = card.querySelector(".exercise-body");
        const toggleBtn = card.querySelector(".exercise-toggle");

        toggleBtn.addEventListener("click", () => {
            const collapsed = body.classList.toggle("collapsed");
            toggleBtn.textContent = collapsed ? "▶" : "▼";
        });

        const header = card.querySelector(".exercise-header");
        header.addEventListener("click", (e) => {
            if (e.target === toggleBtn) return;
            const collapsed = body.classList.toggle("collapsed");
            toggleBtn.textContent = collapsed ? "▶" : "▼";
        });

        const addSetBtn = card.querySelector(".add-set-btn");
        addSetBtn.addEventListener("click", () => addSetRow(card));

        // Start with 1 set row
        addSetRow(card);

        container.appendChild(card);
    }

    function initDefaultExercises() {
        ["push", "legs", "pull"].forEach(dayKey => {
            DEFAULT_SPLIT[dayKey].forEach(name => createExerciseCard(dayKey, name));
        });
    }

    initDefaultExercises();

    // Add exercise buttons
    document.querySelectorAll(".add-exercise-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            const day = btn.getAttribute("data-day");
            const name = prompt("Exercise name:");
            if (name && name.trim()) {
                createExerciseCard(day, name.trim());
            }
        });
    });

    // Save day log
    document.querySelectorAll(".save-day-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            const day = btn.getAttribute("data-day");
            saveDayLog(day);
        });
    });

    function saveDayLog(dayKey) {
        const container = DAY_CONTAINERS[dayKey];
        if (!container) return;

        const cards = container.querySelectorAll(".exercise-card");
        const log = {
            day: dayKey,
            date: new Date().toISOString(),
            exercises: []
        };

        cards.forEach(card => {
            const name = card.querySelector(".exercise-name").textContent.trim();
            const notes = card.querySelector(".exercise-notes").value.trim();
            const sets = [];

            card.querySelectorAll(".set-row").forEach(row => {
                const w = parseFloat(row.querySelector(".set-weight").value);
                const r = parseInt(row.querySelector(".set-reps").value, 10);
                if (isFinite(w) && w > 0 && Number.isFinite(r) && r > 0) {
                    sets.push({ weight: w, reps: r });
                }
            });

            if (name || sets.length || notes) {
                log.exercises.push({ name, notes, sets });
            }
        });

        const logs = loadDayLogs();
        logs.push(log);
        saveDayLogs(logs);

        alert("Day " + (dayKey === "push" ? "1" : dayKey === "legs" ? "2" : "3") + " log saved!");
    }

    // ---- Timers ----
    // Workout timer (stopwatch)
    const workoutDisplay = document.getElementById("workoutDisplay");
    const workoutStartPauseBtn = document.getElementById("workoutStartPause");
    const workoutResetBtn = document.getElementById("workoutReset");

    let workoutSeconds = 0;
    let workoutInterval = null;
    let workoutRunning = false;

    function formatTime(sec) {
        const m = Math.floor(sec / 60);
        const s = sec % 60;
        return String(m).padStart(2, "0") + ":" + String(s).padStart(2, "0");
    }

    function updateWorkoutDisplay() {
        workoutDisplay.textContent = formatTime(workoutSeconds);
    }

    workoutStartPauseBtn.addEventListener("click", () => {
        if (!workoutRunning) {
            workoutRunning = true;
            workoutStartPauseBtn.textContent = "Pause";
            workoutInterval = setInterval(() => {
                workoutSeconds += 1;
                updateWorkoutDisplay();
            }, 1000);
        } else {
            workoutRunning = false;
            workoutStartPauseBtn.textContent = "Start";
            clearInterval(workoutInterval);
        }
    });

    workoutResetBtn.addEventListener("click", () => {
        workoutRunning = false;
        clearInterval(workoutInterval);
        workoutSeconds = 0;
        updateWorkoutDisplay();
        workoutStartPauseBtn.textContent = "Start";
    });

    updateWorkoutDisplay();

    // Rest timer (countdown)
    const restDisplay = document.getElementById("restDisplay");
    const restStartPauseBtn = document.getElementById("restStartPause");
    const restResetBtn = document.getElementById("restReset");
    const restPresetBtns = document.querySelectorAll(".rest-preset");

    let restDuration = 90;
    let restRemaining = 90;
    let restInterval = null;
    let restRunning = false;

    function updateRestDisplay() {
        restDisplay.textContent = String(restRemaining) + "s";
    }

    restPresetBtns.forEach(btn => {
        btn.addEventListener("click", () => {
            const sec = parseInt(btn.getAttribute("data-sec"), 10);
            if (!Number.isFinite(sec)) return;
            restDuration = sec;
            restRemaining = sec;
            updateRestDisplay();
        });
    });

    restStartPauseBtn.addEventListener("click", () => {
        if (!restRunning) {
            if (restRemaining <= 0) restRemaining = restDuration;
            restRunning = true;
            restStartPauseBtn.textContent = "Pause";
            restInterval = setInterval(() => {
                restRemaining -= 1;
                if (restRemaining <= 0) {
                    restRemaining = 0;
                    clearInterval(restInterval);
                    restRunning = false;
                    restStartPauseBtn.textContent = "Start";
                    alert("Rest over — time to hit the next set.");
                }
                updateRestDisplay();
            }, 1000);
        } else {
            restRunning = false;
            restStartPauseBtn.textContent = "Start";
            clearInterval(restInterval);
        }
    });

    restResetBtn.addEventListener("click", () => {
        restRunning = false;
        clearInterval(restInterval);
        restRemaining = restDuration;
        updateRestDisplay();
        restStartPauseBtn.textContent = "Start";
    });

    updateRestDisplay();

    // Defaults
    setUnit("kg");
    barWeightInput.value = 20;
</script>

</body>
</html>
